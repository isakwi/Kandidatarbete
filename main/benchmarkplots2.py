from matplotlib import pyplot as plt
import matplotlib
import re 
import numpy as np


def reWriteVector(vec):
    vec = re.sub(' +', ' ', vec) # removes eccess blank spaces
    vec = vec.replace(" ", ",") # replaces the last blank space with a comma
    vec = vec[1:] # removes the first character i.e. '['
    vec = vec[:-1] # same for the last ']'
    vec = [float(n) for n in vec[1:-1].split(",")] # creates list of floats from the string
    return vec

def reWriteMatrix(mat):
    mat = mat.replace('\n', "") # removes \n from the exp_mat matrix
    mat = re.sub(' +', ' ', mat) # removes eccess blank spaces
    mat = mat.replace(" ", ",") # replaces the last blank space with a comma
    #mat = mat.replace("[", "")
    #mat = mat.replace("]","")
    mat = mat[2:]
    mat = mat[:-1]
    #mat = re.sub("]", "]]", mat)
    #print(mat)
    rows = re.split("[\]\[]", mat)
    rows = list(filter((",").__ne__, rows))
    #print(rows)
    #matrix = np.zeros((len(rows),len(rows[1])))
    matriz = []
    for i in range(1,len(rows)-1):
        #matrix[i] = [float(n) for n in mat[1:-1].split(",")] # creates list of floats from the string
        row = rows[i]
        #print(i)
        #print(row,"hej")
        #row = row[1:] # removes the first character i.e. '['
        #row = row[:-1] # same for the last ']'
        row = row + ","
        matrix_row = [float(n) for n in row[1:-1].split(",")] # creates list of floats from the string
        #print(matrix_row)
        matriz.append(matrix_row)
    mat = matriz
    return mat

def generateMatrices(file_a, file_b, file_c, file_d):
    with open(file_b) as f: # Reads the entire file as one string
        content_b = f.read()

    with open(file_c) as f: # Reads the entire file as one string
        content_c = f.read()

    with open(file_d) as f:
        content_d = f.read()

    with open(file_a) as f:
        content_a = f.read()

    # Splits the text document into multiple strings with the different data
    str1, gamma_vec_a, beta_vec_a, exp_mat_a, minima_a, coord_a, beta_vec_a, zz_a, zo_a, oz_a, oo_a = re.split(".+=", content_a)

    str1, gamma_vec_b, beta_vec_b, exp_mat_b, minima_b, coord_b = re.split(".+=", content_b)

    str1, gamma_vec_c, beta_vec_c, exp_mat_c, minima_c, coord_c = re.split(".+=", content_c)

    str1, gamma_vec_d, beta_vec_d, exp_mat_d, minima_d, coord_d = re.split(".+=", content_d)

    exp_mat_a = reWriteMatrix(exp_mat_a)
    exp_mat_b = reWriteMatrix(exp_mat_b)
    exp_mat_c = reWriteMatrix(exp_mat_c)
    exp_mat_d = reWriteMatrix(exp_mat_d)
    return exp_mat_a, exp_mat_b, exp_mat_c, exp_mat_d



if __name__ == "__main__":
    matplotlib.rcParams.update({'font.size': 12, 'text.usetex': True})

    with open("benchmarkDATA&PLOTS/Old_Data/plotdata_b_longrun.txt") as f: # Reads the entire file as one string
        content_b = f.read()

    with open("benchmarkDATA&PLOTS/Old_Data/plotdata_c_longrun2.txt") as f: # Reads the entire file as one string
        content_c = f.read()

    with open("benchmarkDATA&PLOTS/Old_Data/plotdata_d_longrun.txt") as f:
        content_d = f.read()

    with open("benchmarkDATA&PLOTS/Old_Data/plotdata_a_longrun.txt") as f:
        content_a = f.read()

    # Splits the text document into multiple strings with the different data
    str1, gamma_vec_a, beta_vec_a, exp_mat_a, minima_a, coord_a, beta_vec_a, zz_a, zo_a, oz_a, oo_a = re.split(".+=", content_a)

    str1, gamma_vec_b, beta_vec_b, exp_mat_b, minima_b, coord_b, beta_vec_b, zz_b, zo_b, oz_b, oo_b = re.split(".+=", content_b)

    str1, gamma_vec_c, beta_vec_c, exp_mat_c, minima_c, coord_c, beta_vec_c, zz_c, zo_c, oz_c, oo_c = re.split(".+=", content_c)

    str1, gamma_vec_d, beta_vec_d, exp_mat_d, minima_d, coord_d, beta_vec_d, zz_d, zo_d, oz_d, oo_d = re.split(".+=", content_d)

    '''Betaplot DATA'''
    cost_vec_a = [-0.04187268111185277, -0.009967327569962757, 0.023626950260802956, 0.0590922809439131, 0.0900396484857901, 0.10992447938435647, 0.12663626996951446, 0.12895703375821235, 0.12498047839174155, 0.1080045236558485, 0.08243542986327887, 0.04690461318645364, 0.0013995831572415627, -0.04730477125958311, -0.1034791457589122, -0.16291466455500886, -0.2182146950495836, -0.27551522107463333, -0.3198764305751805, -0.36441322993579445, -0.39824652856600407, -0.4211440961052254, -0.42561265412317417, -0.4190843917782527, -0.40431822686619956, -0.36869806740327543, -0.31965119851477597, -0.2637080976563988, -0.1940895583046257, -0.12361933652205787, -0.03955125555817523, 0.042512909035225074, 0.12422510209309436, 0.20223451057612346, 0.2753163355998, 0.33881253065249517, 0.3942251029608571, 0.4355456284506882, 0.46169990780525605, 0.47287295708063926, 0.47130223320189213, 0.45643024298427604, 0.4296346073467339, 0.3873778719527504, 0.34304000006291036, 0.28464796379440666, 0.22198630045015263, 0.15976582224506855, 0.09861864845160506, 0.03751135967566664, -0.015384939464096447, -0.0629152581335821, -0.10109850687227824, -0.1280197924635591, -0.13856396292762924, -0.15163272532020347, -0.14272452392765902, -0.1337026071236815, -0.10722757631152133, -0.0778379143143994, -0.041264483789890526]
    zz_a = [0.2456267948848067, 0.26119558053722564, 0.2767646563196215, 0.291124745353101, 0.30307045874903205, 0.31079230879061837, 0.3167797991980758, 0.3152542384387081, 0.31003180358509924, 0.29824732217385835, 0.2831055858143917, 0.26241590655630237, 0.23649238037796902, 0.21104740024827476, 0.17947921844105721, 0.14719355080977686, 0.11588987475117836, 0.0856090217836868, 0.0619499044686579, 0.03900891912528702, 0.02078106967204581, 0.005747812537938057, 0.004169848713371096, 0.0059475086855471085, 0.013196711494450735, 0.02997999613055533, 0.055530972903408256, 0.0832530302496073, 0.11951326966874624, 0.1559843503710274, 0.19889731616648884, 0.2415786418818796, 0.28392671040175566, 0.3255646716344279, 0.36478239624741776, 0.39856704094231554, 0.4286986157759554, 0.4523814433274986, 0.4676094715735222, 0.4769455996364766, 0.4785217157200728, 0.47430013887861083, 0.4638025134086852, 0.44456016271053783, 0.4261132894463437, 0.3998958332888046, 0.37049684838035984, 0.3415231479278128, 0.3125253850655454, 0.28527338923429413, 0.2592750554964677, 0.23705866113624502, 0.21994973114313826, 0.20695694398642558, 0.20270277107199963, 0.19580309758660877, 0.20170767882082175, 0.2047574486243785, 0.21720902981450985, 0.23113327446819848, 0.24786496383067497]
    zo_a = [0.26060000858506, 0.2174313022631519, 0.17531032507542124, 0.13702310475697368, 0.10374448471399927, 0.0686770304865282, 0.04466855706230901, 0.02171677874697449, 0.010418569404099387, 0.0033390073217127087, 0.00487323109126965, 0.01248469386850101, 0.02740692657723851, 0.04727040284608218, 0.07355088704472244, 0.10017388309063391, 0.13421276001459742, 0.1648592845760495, 0.19743802151831627, 0.22728581817501894, 0.2549574939480551, 0.2801118412192917, 0.29728987902121445, 0.3123961731125182, 0.3232926351847811, 0.3273445587663105, 0.3254414140719658, 0.31908803942711145, 0.3100257420561161, 0.2933830872897919, 0.2790752556714517, 0.2606239208666764, 0.2432447451840618, 0.2263536277223623, 0.21069526956855963, 0.19901981784453052, 0.1918420607119614, 0.19006331673876378, 0.19226779953314874, 0.19839672326989985, 0.21185139233570358, 0.22873309621386229, 0.24985326396777155, 0.2746367434752028, 0.3022930274016701, 0.3297022139862821, 0.3575106683928981, 0.3847152004958234, 0.4093935945880205, 0.4263457583242947, 0.4462517154900382, 0.4549656210820405, 0.4581140147296806, 0.4542330778621414, 0.44214252409259136, 0.4264446824568164, 0.3984670477061782, 0.3712401938687766, 0.3368672765269893, 0.29932151515214817, 0.2600408943023523]
    oz_a = [0.2873674911594474, 0.2674243188054637, 0.24684686171955617, 0.22906392236555576, 0.2128251582089029, 0.20085514919637146, 0.19009120999522564, 0.18631714333623678, 0.18504261436264566, 0.19025201933432265, 0.20067049811844676, 0.21550830117233155, 0.23509433655135062, 0.25830931647928523, 0.28294949837207195, 0.3101046743810962, 0.33410175442534173, 0.3611206902373499, 0.38194238672896375, 0.4034486699697168, 0.4190286297547623, 0.4268894255088021, 0.4297559241008353, 0.425039404368404, 0.4175147813930292, 0.39867570254016443, 0.37533049546946234, 0.347082631842549, 0.3136039228102903, 0.2796034158619151, 0.23863600366204532, 0.19925781372292564, 0.15981511689800373, 0.12346849729837421, 0.08946721052491195, 0.05975632603081603, 0.03447538697313121, 0.016944031781294017, 0.005911608658616348, 0.0040750101985035465, 0.007286837323745652, 0.017872668477712905, 0.03417600205656397, 0.05718574830136227, 0.08307594815961562, 0.11525018407863541, 0.14851287545558994, 0.18174826171458938, 0.21390872352178059, 0.2477638531997048, 0.2746617347365939, 0.2999742930141385, 0.3210493850654157, 0.33497775768425864, 0.3412661059093116, 0.34743466359974085, 0.3444249422638237, 0.3384590137880977, 0.3242280565262549, 0.30897015682861434, 0.2891280692211132]
    oo_a = [0.20627191633492942, 0.2494723928109155, 0.2913678834132555, 0.33570858279095495, 0.37853341122689915, 0.4196290964619056, 0.4482773038810722, 0.47662901795484347, 0.4945006930453087, 0.508126259924774, 0.5113400795916289, 0.5095828255805067, 0.5009941929658022, 0.4831808295510821, 0.46395188300659373, 0.44252215087881486, 0.4157917411219546, 0.3884058008170242, 0.35827299330278367, 0.3301811614432847, 0.30521803414603094, 0.2872483662674166, 0.26876443544506357, 0.2565988198252763, 0.2459916410543016, 0.24399574232687327, 0.24352916616915196, 0.25044384645326806, 0.25683700613254373, 0.27102641553871676, 0.2831992149018357, 0.2983423800477315, 0.3128945360235371, 0.3244643167306792, 0.33505207207220655, 0.3426531221836725, 0.3449803504038612, 0.3404641448499932, 0.3342078146510075, 0.3205792868126298, 0.30220583056470046, 0.2790901800097811, 0.2521465775870897, 0.22360893239460725, 0.18851432153004957, 0.1551470286883931, 0.12347627202805214, 0.09195372725418012, 0.06416907224086174, 0.04061360146442224, 0.019808366286857886, 0.007996477346239159, 0.0008835695021158465, 0.0038290827346297435, 0.013883943865985092, 0.030312599847703573, 0.0553892205412225, 0.08553947561857024, 0.12148326222723818, 0.16057178263275662, 0.20296284469398215]

    cost_vec_b = [0.00817341564348339, -0.10302987385189888, -0.2049157245798137, -0.30784828398158476, -0.3993508614700884, -0.4910215353509475, -0.5754833695724094, -0.6625027780122525, -0.7280387243161033, -0.7934717991887258, -0.8477657679969252, -0.9027337716074237, -0.9283437362712602, -0.9648425001547639, -0.9859599784267771, -0.9764125344534053, -0.9878834302662266, -0.9655139637209665, -0.9300880808933191, -0.9075984713713865, -0.8577126147452878, -0.8023657311210529, -0.7374248124535748, -0.667550387982863, -0.5828355894739912, -0.5005801597306716, -0.4077148332434032, -0.3121547261805346, -0.21285100249490888, -0.1092157645067909, -0.011944763823527403, 0.09334049316778546, 0.20355551150903034, 0.29831281337864923, 0.3928052876607675, 0.48817144474113106, 0.5783907352863653, 0.6597063168293437, 0.7335369780681867, 0.7967281585535676, 0.853293911689021, 0.901966144728965, 0.943835285573258, 0.9615992579808172, 0.9890953570933916, 0.9877638290153606, 0.9836631384807238, 0.9751572593044676, 0.9487545077367027, 0.9075319347635645, 0.8633392186888957, 0.8053469277307761, 0.7439551752993909, 0.6663420033999328, 0.5826080888638598, 0.5066202633375658, 0.4179996165279964, 0.315093663763701, 0.21645062484134223, 0.11552250583400124, 0.01205990184870059]
    zz_b = [0.2538808088059001, 0.22442423106531215, 0.1981575884366896, 0.17005986549583435, 0.14480329666281452, 0.12047177463536415, 0.09935885898716201, 0.0781231791890136, 0.062452050560244846, 0.04705432009218614, 0.03452905992714485, 0.02200871911888317, 0.016466306466971347, 0.007921732499592098, 0.0032295060610051237, 0.00497948712228083, 0.0020132430193025978, 0.006302827607064691, 0.013341304294291678, 0.017274203568036724, 0.027226775288161333, 0.03831328943216576, 0.05157975113087995, 0.06617613042706853, 0.08432448693910848, 0.10227914409967971, 0.12314045813224948, 0.14522568276194828, 0.16847364537128948, 0.19372564354719332, 0.21842161687837938, 0.24558406335024074, 0.274747677418164, 0.301160151684267, 0.32818336123205977, 0.35675408815714016, 0.38318290244639414, 0.4086781633540029, 0.43183201970682594, 0.45390670302399655, 0.4726505417057799, 0.49089228141495844, 0.5061052133430918, 0.5154327135405232, 0.5264864740500066, 0.5289720414534217, 0.5304595415165273, 0.5297707757836146, 0.5242391544771583, 0.5135701242579322, 0.5004355245145635, 0.4852134290650466, 0.4673884690444176, 0.44561486391917565, 0.42071916439833557, 0.3982122039412957, 0.3724274292472037, 0.342978563476122, 0.3156354943665321, 0.2861928007532146, 0.2571947235678518]
    zo_b = [0.25020586352621577, 0.22547553617554955, 0.2029327239059553, 0.1790871782791833, 0.1565103726705588, 0.13407158651983678, 0.1129529080865397, 0.09065777746965863, 0.0735296931637849, 0.05622230683317048, 0.041591443298623486, 0.026626314950168862, 0.019364836498169752, 0.009658072544031521, 0.003791498749593674, 0.006815475424124802, 0.0040453179824646215, 0.010966333709998326, 0.021613897039245544, 0.028926415783742502, 0.043917034026081894, 0.06052709636330269, 0.07970776192055734, 0.10004925820422327, 0.12425756000527009, 0.14743085001712314, 0.1730026175541855, 0.1986970572089812, 0.22510116558344628, 0.2516668415268939, 0.27560608333369135, 0.30108655009329427, 0.3270303140616564, 0.34799641498078365, 0.36821962562620253, 0.3873317123743747, 0.4060126338604375, 0.42117523001876217, 0.4349363993393921, 0.4444575966672275, 0.4539965190800691, 0.4600907673920099, 0.4658126421015216, 0.4653668156314282, 0.46806129164552907, 0.46491006702502985, 0.46137193694989, 0.45780740863651703, 0.4501381962161247, 0.440195773394697, 0.43123403367106244, 0.4174574115174245, 0.4045891578608913, 0.3875555219492668, 0.37058203923251654, 0.35509640425426836, 0.3365724882425086, 0.31456830813943193, 0.29259365557677075, 0.2715673921950835, 0.24883528879419636]
    oz_b = [0.2555154623420831, 0.2777908594439681, 0.29631156382702195, 0.3185017867783404, 0.3394871596047348, 0.35667280607455565, 0.371211203763419, 0.38598025276701897, 0.39608648449575545, 0.4055386696110362, 0.4115527941647903, 0.4187671567047755, 0.4195846731891337, 0.42305015877214636, 0.4239466776741335, 0.41887311970243146, 0.41890314633459375, 0.41226501340874777, 0.40415589408832847, 0.3987364008751008, 0.38847406552412866, 0.37805907819120116, 0.3657757870246614, 0.35272054150082793, 0.3372360323390841, 0.3221637294759336, 0.30509609246081676, 0.2874550084772393, 0.2680265762544031, 0.24787303680397824, 0.22872094415676417, 0.20728299648829346, 0.18413010969791077, 0.1640112121227878, 0.1432927193768415, 0.12223206259014018, 0.10123946275043676, 0.08230150263332557, 0.06461351460665592, 0.04936339590780982, 0.035383539247820464, 0.023459860720044554, 0.013040348902303472, 0.008753119374941087, 0.0022294885207066796, 0.0029003792164814233, 0.004797830739147676, 0.007845954374909054, 0.01574114799065122, 0.02753916164078874, 0.04016980206366995, 0.056418313990541716, 0.07353502954682772, 0.09467695333078069, 0.1169797177403545, 0.13686559047916402, 0.1595940191301386, 0.18549584780359035, 0.21004526122038303, 0.23340556996094566, 0.2569333216545958]
    oo_b = [0.24039686183980236, 0.26764190164759694, 0.2923892057425784, 0.3247218735602607, 0.35715174226620705, 0.3887254480815532, 0.41629033661663745, 0.44514656254716667, 0.4679266698738712, 0.49114803762643056, 0.5123159068069645, 0.5325931382641031, 0.5445723895750314, 0.5593684195877241, 0.569029009971755, 0.5693275089218682, 0.5750374121962744, 0.5704356246328923, 0.560882530771454, 0.5550618636361385, 0.540378785109031, 0.5230769500983987, 0.5029354289856113, 0.4810527236912848, 0.45417764249077097, 0.42812368192687256, 0.3987595734930519, 0.36862168407573753, 0.3383976055706264, 0.3067338220001111, 0.27724952145616827, 0.2460453799337485, 0.21409142707326945, 0.18683039226140383, 0.16030355269716481, 0.13368018643971216, 0.1095640158461656, 0.08784406383895282, 0.06861623156723701, 0.05227153830679389, 0.03796844449069549, 0.025555950462972626, 0.01504113362548905, 0.010446038327587353, 0.0032219824549026875, 0.0032168502667351477, 0.003369644949728927, 0.004574239553096067, 0.009880752716648233, 0.01869400648134179, 0.028159702889346584, 0.0409066401725167, 0.054486614984602944, 0.0721510447217468, 0.09171504437277611, 0.1098234060102309, 0.131405277561973, 0.15695653162409526, 0.1817211304661598, 0.20883223719612196, 0.2370359725003864]

    cost_vec_c = [0.013518470282559846, -0.09505627606140157, -0.19976091214962133, -0.30194868385412155, -0.3944387660471152, -0.48592455847663446, -0.5672014099761732, -0.6514988270600677, -0.7256370644724245, -0.7884331326894866, -0.8466060316743772, -0.8957406229993642, -0.936389972526074, -0.9650953257453833, -0.9834710404515117, -0.9880580734492977, -0.9809973658994285, -0.9723576767859508, -0.9394260607525758, -0.9076407881375747, -0.8616222533285106, -0.8055906871471443, -0.7429752509586977, -0.6661143932001601, -0.5876572454046382, -0.5039620869917653, -0.41150745620341106, -0.3146253766949948, -0.21463520116876844, -0.11109569738568226, -0.007936098300372233, 0.09476254789645219, 0.19419232411060053, 0.2985113871374823, 0.3978219627564545, 0.48953573022649166, 0.5745803318491032, 0.6560553207963778, 0.7312188320075126, 0.8010285892389075, 0.854509833490285, 0.9050639280443904, 0.9427977043357992, 0.9702524279111531, 0.9866815401223126, 0.9965292201769664, 0.9884380807719342, 0.97287118320324, 0.94673337073018, 0.9141913531980682, 0.8685075137799281, 0.8143813296303334, 0.7500695402728006, 0.6733081273028888, 0.5953322612219133, 0.5100214881136415, 0.4190865867635074, 0.32235967247805053, 0.2232919935637268, 0.1188877045442863, 0.016695132366342947]
    zz_c = [0.25391591901099164, 0.20397963267341618, 0.16166817586851273, 0.12216754449885386, 0.08990612338671412, 0.06367635682696636, 0.044662700247332224, 0.028458399312741137, 0.017235872942642068, 0.009886212955101982, 0.004861791078507025, 0.0019963763627773887, 0.0005671844370585295, 9.401170557499035e-05, 5.706531809076665e-05, 0.00013483201173473993, 0.00026288088906054063, 0.00038903287184170943, 0.0010608400633964267, 0.0021953568692824055, 0.004702389046418968, 0.009195103512302651, 0.016022598709497488, 0.027141408930664072, 0.041514053294632064, 0.060278065428647554, 0.08507572384074046, 0.11570847900440971, 0.15211703922807612, 0.19546089776532802, 0.24386364021925458, 0.2974089889602846, 0.35430246545374494, 0.4193861225192312, 0.4864321643604609, 0.5528258315076338, 0.6181269675065607, 0.6841854379240341, 0.7480969428255496, 0.8099993610240068, 0.8591230226532407, 0.9068904575654809, 0.9433970985783606, 0.9704293781459241, 0.9868071014536137, 0.9966903116380897, 0.9886359512445805, 0.97320701749872, 0.9474609826049879, 0.9158903324260277, 0.8724600039040598, 0.822370182576449, 0.7647681680486789, 0.6987483997060676, 0.6347053809240832, 0.5681960557588134, 0.5012778903717646, 0.43470004856753847, 0.37144295725300214, 0.3101139375079973, 0.25544322408003783]
    zo_c = [0.2501707506272174, 0.247178010906827, 0.24107150344511308, 0.22711780547037003, 0.21068680033851173, 0.1898501370140472, 0.17050378895450974, 0.14446859413992222, 0.11735135128611895, 0.09474075044146946, 0.07103744799431275, 0.05029754113787672, 0.029011578352231, 0.01633161780723971, 0.005926133555941166, 0.005721576879929529, 0.010701727896918948, 0.011848606653454831, 0.029497511812383335, 0.044181502307720194, 0.06481298823089963, 0.0885021163916565, 0.11242178970245678, 0.14199934323623745, 0.1662210012887083, 0.1879852159122043, 0.20970149276666034, 0.2277791130044095, 0.2412929017661357, 0.250558746948784, 0.25428913233077954, 0.2515799302756777, 0.24165006484571916, 0.2305461199142456, 0.21403665578429434, 0.19273635024769378, 0.1684119992847868, 0.14441736911749084, 0.1169975458390769, 0.09157947397520766, 0.0669772578242647, 0.04548065482256128, 0.028594028682901763, 0.01356089498047392, 0.0046952967802651934, 0.002135222433809882, 0.0030148906807125294, 0.011692168999265829, 0.02443248468760883, 0.04021189207766355, 0.05994754666261811, 0.0835222668834854, 0.10889134955805271, 0.13428533359274014, 0.16026460711859963, 0.18455462128232514, 0.20641212005405804, 0.2245608738610234, 0.237974171260812, 0.24672126862365795, 0.25117003219914324]
    oz_c = [0.2555161336716304, 0.2523919292006451, 0.2423195429012947, 0.23231553795453652, 0.21699862028416056, 0.19698141656793722, 0.1730872963351364, 0.14720432401912387, 0.12254276832914325, 0.09708754833220172, 0.07264711879976142, 0.04997257047350851, 0.03347732112235854, 0.01838790220090512, 0.01049183094741635, 0.005956567093976455, 0.007776167843517062, 0.015018415843714251, 0.02896368207978, 0.04378726079842274, 0.06416235652055403, 0.08751968593802106, 0.11255832821311583, 0.13760538243864412, 0.1631174566378279, 0.18749850451088532, 0.20864153263238513, 0.2261788760693473, 0.23983877976243415, 0.24742509350559744, 0.25004793364620764, 0.24836610671574652, 0.24393900738385607, 0.22919350649200862, 0.2109215971234394, 0.1911546546259969, 0.1699149726485747, 0.14326746887536634, 0.1180277614754443, 0.089450654021706, 0.06928674475307812, 0.04580324964043445, 0.027409663695578745, 0.015832914963754958, 0.008372158169875262, 0.0010134706754621474, 0.008151388985355789, 0.014765975253377172, 0.02737962930431933, 0.04219895737841286, 0.06364001739043466, 0.08611876188385431, 0.11164192330484442, 0.14152641484626083, 0.16565699482037963, 0.18907486325227107, 0.210118827963153, 0.22839896902279014, 0.24243272952524783, 0.251939965233291, 0.2546390132389696]
    oo_c = [0.2403964153634181, 0.2916814503093177, 0.3439952990554068, 0.4095213872013776, 0.47960862555071104, 0.5493466495846799, 0.6115935990117187, 0.6797566299406765, 0.742865130523664, 0.7982465879452212, 0.8514377531966705, 0.8977290081505921, 0.9369298432229298, 0.9651833880363533, 0.9835216987698214, 0.9881809834354164, 0.9812577218028019, 0.9727411488258865, 0.9404687134635368, 0.9098355531783268, 0.86631984095385, 0.814779897639957, 0.7589967100448691, 0.6932517440652138, 0.6291175772665523, 0.5642361442596348, 0.49657902217972155, 0.43033317276333827, 0.3667500722832441, 0.30655314916783005, 0.251798746270554, 0.20264308774169879, 0.16010654518861592, 0.12087347461875016, 0.08860848249577077, 0.06325664818762164, 0.04354496800757613, 0.028128661983510408, 0.016876943687639014, 0.008969645850231394, 0.004612263998404596, 0.0018238979426205173, 0.0005983722360379486, 0.000176070233749403, 0.00012466439986119442, 0.0001602335986395499, 0.00019694392217971352, 0.0003264066018897673, 0.0007242206057448034, 0.0016977140835849655, 0.003951681393037062, 0.007987968250383493, 0.014697845609681074, 0.0254363525753321, 0.03937219796564292, 0.05817368158283699, 0.08219031306754729, 0.11233806698553758, 0.14814662772450538, 0.19122145834161136, 0.23874541131134874]

    cost_vec_d = [-0.14431482026968404, 0.06156949442135123, 0.2660430610824668, 0.4595861336106234, 0.6302221215350922, 0.7726172082044972, 0.8810445703004743, 0.9608213988059335, 0.9887632803621964, 0.9795196710979956, 0.9277240233261775, 0.8296114990229582, 0.6983608075982198, 0.5517469257731252, 0.36678775013777454, 0.1712773329561394, -0.0333822713491318, -0.23275896588027517, -0.42396935571229083, -0.594489872998186, -0.7361084332159713, -0.8475850914700696, -0.9152545509012157, -0.9461922019048099, -0.9291065327415199, -0.8800237118358736, -0.7825124325973336, -0.6524140829087034, -0.4980598206517786, -0.3131344127391917, -0.11906551221096376, 0.08171418380363929, 0.28362219752376316, 0.4693187516339318, 0.6427748794727742, 0.786308741821032, 0.8872467109167191, 0.9664101966401915, 0.988393315940043, 0.976185554916593, 0.9160004374333691, 0.8209764636095049, 0.6921381299116708, 0.524828279709439, 0.3438503434331266, 0.14902856951755353, -0.057553986135357706, -0.25988985605956155, -0.45134382175793214, -0.6197920588545172, -0.7708145341114371, -0.8809163669151813, -0.9490100767121017, -0.9813654655687463, -0.9683299639393389, -0.914648546707633, -0.8212849105085618, -0.6889312100682902, -0.527530910341765, -0.34607323877878177, -0.14528665273747127]
    zz_d = [0.23593065786397774, 0.2910726562056411, 0.3430841200475446, 0.39301814705333116, 0.4379649432762729, 0.47634296852083646, 0.5044385972070605, 0.523975114633035, 0.5313981676429267, 0.528732085329339, 0.5153253122287292, 0.49004555595979005, 0.45731446745780513, 0.41760666747319736, 0.37019299819503304, 0.3185742500214008, 0.26555783931731675, 0.21386177399661607, 0.16261308799284419, 0.11630814291911884, 0.07783014879767913, 0.046375562046874534, 0.025675460614481196, 0.014668138152046572, 0.015277420474516077, 0.02404656666998127, 0.0442380854497004, 0.0750268252780442, 0.10894494201282483, 0.15199285034115628, 0.1978459708266721, 0.24466541395583272, 0.2939882862499463, 0.3369608634001208, 0.37908360481216424, 0.4146609123114608, 0.43664163670071043, 0.4580013479871536, 0.4600290719846334, 0.4600766325206078, 0.4457084062022831, 0.4216640734950153, 0.39159983073413906, 0.3505321627574465, 0.3060744364464788, 0.2613622168918894, 0.21197006636950766, 0.165417001866751, 0.11863663592458222, 0.07913631304106515, 0.04569476101436305, 0.021748232508034822, 0.008967294412699098, 0.003608811708068434, 0.011360048120359498, 0.027741974544339305, 0.05443933635252825, 0.09211501971631875, 0.13471293238330034, 0.18421033780697688, 0.2379995657350809]
    zo_d = [0.2682804385356883, 0.2184723438294875, 0.16837564125307328, 0.12326677028054024, 0.08197692731683386, 0.04998158446275018, 0.024546691327753646, 0.006604002867084965, 0.0017234419716698269, 0.006595947981790347, 0.023019399358853797, 0.04971384945876487, 0.08397219142763734, 0.12351203881095675, 0.1712162290957457, 0.2227548502796216, 0.2743630914089556, 0.3259566570017486, 0.3754316409233602, 0.41975157988028033, 0.45644374931345927, 0.4835683441689983, 0.49966794438050705, 0.5071254992775303, 0.5061817425396944, 0.49167704162466114, 0.46608219997098194, 0.43496167761415006, 0.39548387102203725, 0.34582728132119744, 0.29702225671904625, 0.24513292383007532, 0.19348229460809774, 0.14508238483351402, 0.09941567984939856, 0.06208876822532299, 0.03289333682459886, 0.010668022729963717, 0.00344910088510556, 0.003060393182144973, 0.016162542826670387, 0.03836589806974661, 0.06745099076061499, 0.10867007914445447, 0.15217440375249572, 0.1969149977786996, 0.24778078110270263, 0.2955517235217992, 0.34505255502731735, 0.38625353920024397, 0.4200561945319752, 0.44771020993479727, 0.4655484132232634, 0.4736989529963413, 0.47155257139554285, 0.4560575788251279, 0.4329325362677822, 0.4013814125022194, 0.3618702505059531, 0.3182248728502522, 0.2696705618233334]
    oz_d = [0.3033180070603547, 0.24837830241673572, 0.19570718698236714, 0.14646535994480805, 0.10305446615229485, 0.06361119555356438, 0.0348209012518689, 0.013030580531242144, 0.0032813692530925267, 0.003307878355513598, 0.013121780978433915, 0.03548483037378527, 0.06662007134382951, 0.10061370134743387, 0.14539592472686855, 0.1916097015141312, 0.2423292226230569, 0.29042620117083445, 0.3365537552645221, 0.3774946618336053, 0.4116109772871002, 0.44022725512234856, 0.4579587426224038, 0.46596970860003684, 0.4584601385713157, 0.4483068337652842, 0.4252969185332257, 0.39136871937182666, 0.3540673888310248, 0.31125113665573645, 0.26250531350647643, 0.21400597031423507, 0.16489295857015016, 0.12048119243341901, 0.07918889155985968, 0.044751368378448474, 0.023629293470293383, 0.006121491202246351, 0.002348303972873179, 0.008978412731185994, 0.0258314604001828, 0.051140059715029905, 0.08647311862034439, 0.1288860756980992, 0.17590200497540956, 0.2285651184894498, 0.28099145707600187, 0.33438747723781614, 0.3806146849243297, 0.42363874072702745, 0.4653469587171159, 0.49204812804791187, 0.5089537315794486, 0.5169809246256984, 0.5124253296714546, 0.5012597125417555, 0.4768608664088191, 0.44308333327526067, 0.40164307998246385, 0.3547705913361953, 0.30297294524543644]
    oo_d = [0.19218781618287278, 0.23787294631040962, 0.28318954502348676, 0.3296758472201395, 0.3747156800993075, 0.40995141121344686, 0.4359414598816645, 0.45630965936482826, 0.4631852071933297, 0.4610548070548156, 0.4485245290267816, 0.424742222703826, 0.39182867186215237, 0.3582638194104782, 0.3131831651938018, 0.2670552976120488, 0.21774504885462462, 0.16974831923401132, 0.1253974387177947, 0.08643875613113018, 0.05410963837743134, 0.02981855141065335, 0.01669254988907581, 0.012232694553091474, 0.01994858151543243, 0.03595200023450219, 0.06423450325879879, 0.09850028677575753, 0.14095370721679387, 0.19040339883837418, 0.2426214070240951, 0.29619190398427875, 0.3474333503901762, 0.3972219424457845, 0.4422989070435067, 0.4784953141386388, 0.5066148100576185, 0.5252053184819613, 0.5341700827859854, 0.5275218923491894, 0.5122935839367323, 0.4888264709621542, 0.45446179761474975, 0.41177367239344, 0.36583048893489706, 0.3131539289136997, 0.259254342158144, 0.20463903113578305, 0.15569249988436104, 0.11096802649048282, 0.06889837878898374, 0.037989008978845946, 0.016527076099137027, 0.0057076587854813406, 0.004551196922650139, 0.014934039522261092, 0.03531165358055631, 0.06341681370803376, 0.10164205407177102, 0.1427701377923308, 0.1893534939906641]


    gamma_vec_a = reWriteVector(gamma_vec_a)
    beta_vec_a = reWriteVector(beta_vec_a)
    exp_mat_a = reWriteMatrix(exp_mat_a)

    gamma_vec_b = reWriteVector(gamma_vec_b)
    beta_vec_b = reWriteVector(beta_vec_b)
    exp_mat_b = reWriteMatrix(exp_mat_b)

    gamma_vec_c = reWriteVector(gamma_vec_c)
    beta_vec_c = reWriteVector(beta_vec_c)
    exp_mat_c = reWriteMatrix(exp_mat_c)

    gamma_vec_d = reWriteVector(gamma_vec_d)
    beta_vec_d = reWriteVector(beta_vec_d)
    exp_mat_d = reWriteMatrix(exp_mat_d)

    gamma_vec = gamma_vec_b
    beta_vec = beta_vec_b

    # plotting matrix
    # plt.matshow(exp_mat, cmap = plt.get_cmap('PiYG'))  # We need to flip the matrix of we use the matshow
    # Do this by putting exp_mat[beta_resolution-1-j, i] = np.mean(expect(ham, state)) in for loops!) !
    fig, ax = plt.subplots(2,2, tight_layout = False)
    cs_a = ax[0,0].contourf(gamma_vec_a, beta_vec_a, exp_mat_a, 400, cmap=plt.get_cmap('PiYG'), vmin=-1, vmax=1, levels=np.linspace(-1,1,345))
    cs_b = ax[0,1].contourf(gamma_vec_b, beta_vec_b, exp_mat_b, 400, cmap=plt.get_cmap('PiYG'), vmin=-1, vmax=1, levels=np.linspace(-1,1,345))
    cs_c = ax[1,0].contourf(gamma_vec_c, beta_vec_c, exp_mat_c, 400, cmap=plt.get_cmap('PiYG'), vmin=-1, vmax=1, levels=np.linspace(-1,1,345))
    cs_d = ax[1,1].contourf(gamma_vec_d, beta_vec_d, exp_mat_d, 400, cmap=plt.get_cmap('PiYG'), vmin=-1, vmax=1, levels=np.linspace(-1,1,345))
    # This one plots the matrix with angles

    labels = ["0", "$\pi$/2", "$\pi$"]
    cbar = fig.colorbar(cs_b, ticks=np.linspace(-1,1,9), ax=ax)
    ticks = [gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]]
    plt.setp(ax, xticks=ticks, xticklabels=labels, yticks=ticks, yticklabels=labels)

    #ax[0,0].set_title(f'Cost function F($\gamma$, \u03B2) for problem a')
    ax[0,0].set_ylabel("\u03B2$_1$")
    #plt.xticks([gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]], labels)
    #plt.yticks([gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]], labels)
    ax[0,0].text(0.05, 0.85, '$(a)$', fontsize = 18, weight='bold', transform=ax[0,0].transAxes)

    #ax[0,1].set_title(f'Cost function F($\gamma$, \u03B2) for problem b')
    ax[0,1].text(0.05,0.85, '$(b)$', fontsize = 18, weight='bold', transform=ax[0,1].transAxes)
    #plt.xticks([gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]], labels)
    #plt.yticks([gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]], labels)

    #ax[1,0].set_title(f'Cost function F($\gamma$, \u03B2) for problem c')
    ax[1,0].set_xlabel("$\gamma_1$")
    ax[1,0].set_ylabel("\u03B2$_1$")
    ax[1,0].text(0.05, 0.85, '$(c)$', fontsize = 18, weight='bold', transform=ax[1,0].transAxes)
    #plt.xticks([gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]], labels)
    #plt.yticks([gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]], labels)

    #ax[1,1].set_title(f'Cost function F($\gamma$, \u03B2) for problem d')
    ax[1,1].set_xlabel("$\gamma_1$")
    ax[1,1].text(0.05, 0.85, '$(d)$', fontsize = 18, weight='bold', transform=ax[1,1].transAxes)
    #plt.xticks([gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]], labels)
    #plt.yticks([gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]], labels)

    plt.show()
    fig.savefig("benchmarkplot.png", format="png", bbox_inches="tight")

    #coord_a = [22, 16]
    #coord_b = [44, 44]
    #coord_c = [15, 28]
    #coord_d = [37, 44]

    #cost_vec_a = [cost[coord_a[1]] for cost in exp_mat_a]
    #cost_vec_b = [cost[coord_b[1]] for cost in exp_mat_b]
    #cost_vec_c = [cost[coord_c[1]] for cost in exp_mat_c]
    #cost_vec_d = [cost[coord_d[1]] for cost in exp_mat_d]


    fig2, ax2 = plt.subplots(2,2)
    """
    for i in ax2[0,:]:
        for j in ax2[1,:]:
            print(j)
            handles, labels = j.get_legend_handles_labels()
            print(handles)
            print(labels)
            #j.legend(handles, labels, loc='upper center')
    """
    beta_vec = np.linspace(0,np.pi,61)
    ax2[0,0].set(xlim= (0,np.pi), ylim= (-1, 1))

    ax2[0,0].plot(beta_vec, cost_vec_a, 'o',markerfacecolor='none', markeredgecolor ="magenta", label="F")
    ax2[0,0].plot(beta_vec, zz_a, 'o',markerfacecolor='none', markeredgecolor ="orange", label="P(|00>)")
    ax2[0,0].plot(beta_vec, zo_a, 'o',markerfacecolor='none', markeredgecolor ="red", label="P(|01>)")
    ax2[0,0].plot(beta_vec, oz_a, 'o',markerfacecolor='none', markeredgecolor ="green", label="P(|10>)")
    ax2[0,0].plot(beta_vec, oo_a, 'o',markerfacecolor='none', markeredgecolor ="purple",  label="P(|11>)")

    ax2[0,0].text(0.05, 0.85, '$(a)$', fontsize = 18, weight='bold', transform=ax2[0,0].transAxes)

    ax2[0,0].set_xlabel(r"$\beta$")
    ax2[0,0].set_ylabel("$F,P$")


    #cost_vec_b.reverse() # reverses the list
    #zz_b.reverse()
    #zo_b.reverse()
    #oz_b.reverse()
    #oo_b.reverse()

    ax2[0,1].plot(beta_vec, cost_vec_b, 'o',markerfacecolor='none', markeredgecolor ="magenta", label="F")
    ax2[0,1].plot(beta_vec, zz_b, 'o',markerfacecolor='none', markeredgecolor ="orange", label="P(|00>)")
    ax2[0,1].plot(beta_vec, zo_b, 'o',markerfacecolor='none', markeredgecolor ="red", label="P(|01>)")
    ax2[0,1].plot(beta_vec, oz_b, 'o',markerfacecolor='none', markeredgecolor ="green", label="P(|10>)")
    ax2[0,1].plot(beta_vec, oo_b, 'o',markerfacecolor='none', markeredgecolor ="purple",  label="P(|11>)")

    ax2[0,1].text(0.05, 0.85, '$(b)$', fontsize = 18, weight='bold', transform=ax2[0,1].transAxes)

    ax2[1,0].plot(beta_vec, cost_vec_c, 'o',markerfacecolor='none', markeredgecolor = "magenta", label="F")
    ax2[1,0].plot(beta_vec, zz_c, 'o',markerfacecolor='none', markeredgecolor = "orange", label="P(|00>)")
    ax2[1,0].plot(beta_vec, zo_c, 'o',markerfacecolor='none', markeredgecolor ="red", label="P(|01>)")
    ax2[1,0].plot(beta_vec, oz_c, 'o',markerfacecolor='none', markeredgecolor ="green", label="P(|10>)")
    ax2[1,0].plot(beta_vec, oo_c, 'o',markerfacecolor='none', markeredgecolor ="purple",  label="P(|11>)")
    ax2[1,0].set_xlabel("\u03B2$_1$")
    ax2[1,0].set_ylabel("$F,P$")


    ax2[1,0].text(0.05, 0.85, '$(c)$', fontsize = 18, weight='bold', transform=ax2[1,0].transAxes)

    #cost_vec_d.reverse()
    #zz_d.reverse()
    #zo_d.reverse()
    #oz_d.reverse()
    #oo_d.reverse()

    ax2[1,1].plot(beta_vec, cost_vec_d, 'o',markerfacecolor='none', markeredgecolor ="magenta", label="F")
    ax2[1,1].plot(beta_vec, zz_d, 'o',markerfacecolor='none', markeredgecolor ="orange", label="P(|00>)")
    ax2[1,1].plot(beta_vec, zo_d, 'o',markerfacecolor='none', markeredgecolor ="red", label="P(|01>)")
    ax2[1,1].plot(beta_vec, oz_d, 'o',markerfacecolor='none', markeredgecolor ="green", label="P(|10>)")
    ax2[1,1].plot(beta_vec, oo_d, 'o',markerfacecolor='none', markeredgecolor ="purple",  label="P(|11>)")
    ax2[1,1].set_xlabel("\u03B2$_1$")

    ax2[1,1].text(0.05, 0.85, '$(d)$', fontsize = 18, weight='bold', transform=ax2[1,1].transAxes)

    #ax2.legend()
    #ax2.set(xlim= (0,pi), ylim= (-1, 1))
    #Title if you want, uncomment then
    #ax2.set_title('Problem {problem}')
    #ax2.set_xlabel(r"$\beta$")
    #ax2.set_ylabel("Cost function or probability of occupation")

    xticks = [gamma_vec[0], (gamma_vec[-1] + gamma_vec[0])/2, gamma_vec[-1]]
    yticks = [-1,0,1]
    xlabels = ["0", "$\pi$/2", "$\pi$"]
    ylabels = ["-1", "0", "1"]
    plt.setp(ax2, xticks=xticks, xticklabels=xlabels,yticks=yticks, yticklabels=ylabels) #,yticks=yticks, yticklabels=ylabels)

    """
    #handles, labels = ax2[1,1].get_legend_handles_labels()
    ax2[0,0].legend(loc='center')
    ax2[0,1].legend(loc='center')
    ax2[1,0].legend(loc='center')
    ax2[1,1].legend(loc='center')
    """
    handles, labels = ax2[0,0].get_legend_handles_labels()
    fig2.legend(handles, labels, loc='upper center',ncol=5)

    plt.show()
    fig.savefig("betaplotbenchmark.png", format="png", bbox_inches="tight")
    fig.savefig("betaplotbenchmark.pdf", format="pdf", bbox_inches="tight")
